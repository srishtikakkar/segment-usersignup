<!DOCTYPE html>
<html>

<head>
   <title>Login</title>

   <script>

class utm_enricher_plugin {
  constructor() {
    this.name = 'UTM Enricher';
    // before, enrichment, destination, after, utility
    this.type = 'enrichment';
    this.version = '1';
  }
  isLoaded() {
    return true;
  }
  async load(ctx, analytics) {
    // parse URL for utm params
    console.log("loading plugin");
    const queryString = window.location.search;
    console.log(queryString);
    if (queryString !== '') {
      console.log("setting UTM params");
      const urlParams = new URLSearchParams(queryString);
      const medium = urlParams.get('utm_medium');
      const source = urlParams.get('utm_source');
      const content = urlParams.get('utm_content');
      const tactic = urlParams.get('utm_tactic');
      const link = urlParams.get('utm_link');
      var utm_params = JSON.stringify({medium: medium, source: source, content: content, tactic: tactic, link: link });
      localStorage.setItem("utm_params", utm_params);
      console.log(utm_params);
    }
    return;
  }
  async track(ctx) {
    console.log("modifying track event");
    ctx.event.properties.new_property = "howdy";
    var utm_params = JSON.parse(localStorage.getItem("utm_params:"));
    console.log(utm_params);
    ctx.event.properties.utm_params = utm_params;
    return ctx;
  }
  async page(ctx) {
    ctx.event.properties.new_property = "howareye";
    console.log("modifying page event");
    ctx.event.properties.new_property = "howdy";
    var utm_params = JSON.parse(localStorage.getItem("utm_params:"));
    console.log(utm_params);
    ctx.event.properties.utm_params = utm_params;
    return ctx;
  }
}
await window.analytics.register(new utm_enricher_plugin());

   </script>

   
   <script>
      !function () {
         var analytics = window.analytics = window.analytics || []; if (!analytics.initialize) if (analytics.invoked) window.console && console.error && console.error("Segment snippet included twice."); else {
            analytics.invoked = !0; analytics.methods = ["trackSubmit", "trackClick", "trackLink", "trackForm", "pageview", "identify", "reset", "group", "track", "ready", "alias", "debug", "page", "once", "off", "on", "addSourceMiddleware", "addIntegrationMiddleware", "setAnonymousId", "addDestinationMiddleware"]; analytics.factory = function (e) { return function () { var t = Array.prototype.slice.call(arguments); t.unshift(e); analytics.push(t); return analytics } }; for (var e = 0; e < analytics.methods.length; e++) { var key = analytics.methods[e]; analytics[key] = analytics.factory(key) } analytics.load = function (key, e) { var t = document.createElement("script"); t.type = "text/javascript"; t.async = !0; t.src = "https://cdn.segment.com/analytics.js/v1/" + key + "/analytics.min.js"; var n = document.getElementsByTagName("script")[0]; n.parentNode.insertBefore(t, n); analytics._loadOptions = e }; analytics._writeKey = "wvwAdj28GcUK0TPhfPu2eJgCv1Y7vVAC";; analytics.SNIPPET_VERSION = "4.15.3";
            analytics.load("wvwAdj28GcUK0TPhfPu2eJgCv1Y7vVAC");
            analytics.page("Login");
         }
      }();
   
   </script>
   <script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:3608654,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
   </script>
</head>

<body>
   <h1>Login</h1>
   <form id="login-form">
      <label for="email">Email:</label>
      <input type="email" id="email" name="email" required><br>

      <label for="password">Password:</label>
      <input type="password" id="password" name="password" required><br>

      <button type="submit" id="login-button">Login</button>
   </form>

   <script>
      // Retrieve the user ID from local storage
      const userID = localStorage.getItem('userID');
      const email = localStorage.getItem('email');
      const password = localStorage.getItem('password');
      console.log('User ID:', userID);

      // Handle the form submission
      const form = document.querySelector('#login-form');
      form.addEventListener('submit', function (event) {
         event.preventDefault(); // Prevent the default form submission behavior

         // Get the input values
         const inputemail = document.querySelector('#email').value;
         const inputpassword = document.querySelector('#password').value;

         // Perform authentication logic here
         if (inputemail === email && inputpassword === password) {
            
            analytics.track('Button Clicked',{
               button_type:'Login',
               button_text:'submit'
            });
            
            alert('Login successful');
            
            analytics.track('Alert Displayed',{
               alert_type: 'Login Success'
            });
            
            analytics.track('Alert Clicked',{
               alert_type:'Login Success',
               alert_text:'OK'
            });
            
            analytics.identify({
               email:email
            });
               
            // Redirect the user to the dashboard page
            window.location.href = 'success.html';
         } else {
            alert('Invalid email or password');
            
            analytics.track('Alert Displayed',{
               alert_type:'Login Failed',
            });
            
            analytics.track('Alert Clicked',{
               alert_type:'Login Fail',
               alert_text:'Invalid details'
            });
         }
      });
   </script>


</body>

</html>
